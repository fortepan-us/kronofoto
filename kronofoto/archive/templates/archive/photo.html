{% extends "archive/base.html" %}
{% load static %}
{% load timeline %}
{% load thumbnails %}
{% load photometadata %}

{% block content %}
  <main>
    <div class="click-content"></div>
    
    <article class="fi-image">
      <figure>
        <img id="fi-image" src="{{ photo.h700.url }}" alt="Alt text for the image">
      </figure>
      <a id="fi-arrow-left" class="control previous"
      {% if photo.previous %}
        href="{{ photo.previous.get_absolute_url }}"
        data-json-href="{{ photo.previous.get_json_url }}"
      {% endif %}
      ></a>
      <a id="fi-arrow-right" class="control forward"
      {% if photo.next %}
          href="{{ photo.next.get_absolute_url }}"
          data-json-href="{{ photo.next.get_json_url }}"
      {% endif %}
      ></a>
      <button id="expand" onclick="toggleVis()">+</button>
      <div id="metadata" class="hidden">
        {% photo_metadata photo user %}
      </div>
    </article>
    

    <nav class="fi-timeline">
      <div class="fi-thumbnail-carousel">
        <div class="back-arrows">
{% if page.has_previous %}
    <a id="backward" data-json-href="{{ prev_page.0.get_json_url }}" href="{{ prev_page.0.get_absolute_url }}">
{% endif %}
        <img src="{% static "assets/images/double-back-arrow-black.png" %}" alt="arrows pointing back">
{% if page.has_previous %}
    </a>
{% endif %}
        </div>
        <div class="slide-container">
        <ul id="fi-preload-zone">
        </ul>
        <ul id="fi-thumbnail-carousel-images">
            {% make_thumbnails page prev_page next_page getparams %}
        </ul>
        </div>
        <div class="forward-arrows">
{% if page.has_next %}
    <a id="forward" href="{{ next_page.0.get_absolute_url }}" data-json-href="{{ next_page.0.get_json_url }}">
{% endif %}
      <img src="{% static "assets/images/double-back-arrow-black.png" %}" alt="arrows pointing forward">
        
{% if page.has_next %}
    </a>
{% endif %}
        </div>
      </div>
      <div class="year-ticker">
        <div class="year-min">
          <img src="{% static "assets/images/single-back-arrow-black.png" %}" alt="arrow pointing back">
          {{ first_year }}
        </div>
        {% make_timeline years %}
        <div class="year-max">
          {{ last_year }}
          <img src="{% static "assets/images/single-back-arrow-black.png" %}" alt="arrow pointing forward">
        </div>
      </div>
    </nav>
  </main>
  {{ initialstate | json_script:"initial-state" }}
  <script>
    let current_state = JSON.parse(document.getElementById('initial-state').textContent)
    window.history.replaceState(current_state, 'Fortepan Iowa', current_state.url)
  </script>
{% endblock %}
